(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[253],{1397:(e,s,t)=>{"use strict";t.d(s,{k:()=>i});var a=t(5155);t(2115);var l=t(1838),r=t(3999);function i(e){let{className:s,value:t,...i}=e;return(0,a.jsx)(l.bL,{"data-slot":"progress",className:(0,r.cn)("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",s),...i,children:(0,a.jsx)(l.C1,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:"translateX(-".concat(100-(null!=t?t:0),"%)")}})})}},1760:e=>{function s(e){var s=Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}s.keys=()=>[],s.resolve=s,s.id=1760,e.exports=s},3999:(e,s,t)=>{"use strict";t.d(s,{bN:()=>i,cn:()=>r});var a=t(2596),l=t(9688);function r(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,l.QP)((0,a.$)(s))}function i(){let e=new Date,s=e.getDay(),t=new Date(e);return t.setDate(e.getDate()-(0===s?6:s-1)),t.setHours(0,0,0,0),t.toISOString()}},5086:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>u});var a=t(5155),l=t(2115),r=t(9671),i=t(1397),n=t(3540),c=t(8003),d=t(4754),m=t(6025),o=t(2071),x=t(6254),h=t(64);function u(){var e,s,t,u,g,p,j;let[N,f]=(0,l.useState)(null),[y,b]=(0,l.useState)(null),[v,_]=(0,l.useState)([]),[w,k]=(0,l.useState)([]),[S,E]=(0,l.useState)(!0),[C,A]=(0,l.useState)(null),I=(0,r.UU)(),L=(0,l.useCallback)(async e=>{try{let{data:s}=await I.from("clients").select("*").eq("auth_user_id",e).single();if(s&&"object"==typeof s&&s&&"id"in s&&"coach_id"in s){f(s);let{data:e}=await I.from("weekly_plans").select("*").eq("client_id",s.id).eq("status","active").order("week_start_date",{ascending:!1}).limit(1).single();e&&"object"==typeof e&&"id"in e&&"coach_id"in e&&b(e);let{data:t}=await I.from("check_ins").select("*").eq("client_id",s.id).order("check_in_date",{ascending:!1}).limit(10);t&&Array.isArray(t)&&t.every(e=>e&&"object"==typeof e&&"id"in e&&"coach_id"in e)&&_(t);let{data:a}=await I.from("progress_metrics").select("*").eq("client_id",s.id).order("metric_date",{ascending:!0}).limit(30);a&&Array.isArray(a)&&a.every(e=>e&&"object"==typeof e&&"id"in e&&"coach_id"in e)&&k(a)}}catch(e){A("Failed to load client data")}finally{E(!1)}},[I]),U=(0,l.useCallback)(async()=>{try{let{data:{user:e}}=await I.auth.getUser();e?await L(e.id):E(!1)}catch(e){A("Authentication error"),E(!1)}},[L,I.auth]);(0,l.useEffect)(()=>{U()},[U]);let D=async e=>{e.preventDefault();let s=new FormData(e.currentTarget),t=s.get("email"),a=s.get("password");try{let{error:e}=await I.auth.signInWithPassword({email:t,password:a});e?A(e.message):await U()}catch(e){A("Sign in failed")}},P=async()=>{await I.auth.signOut(),f(null),b(null),_([]),k([])};if(S)return(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Loading your portal..."})]})});if(!N)return(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50 flex items-center justify-center p-6",children:(0,a.jsxs)("div",{className:"w-full max-w-md",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-100 rounded-3xl mb-6",children:(0,a.jsx)("svg",{className:"w-8 h-8 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),(0,a.jsx)("h1",{className:"text-headline font-bold text-gray-900 mb-2",children:"Client Portal"}),(0,a.jsx)("p",{className:"text-body text-gray-600",children:"Sign in to view your progress and plans"})]}),(0,a.jsx)("div",{className:"card p-8",children:(0,a.jsxs)("form",{onSubmit:D,className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"email",className:"text-sm font-medium text-gray-700",children:"Email"}),(0,a.jsx)("input",{id:"email",name:"email",type:"email",required:!0,className:"input w-full",placeholder:"your.email@example.com"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"password",className:"text-sm font-medium text-gray-700",children:"Password"}),(0,a.jsx)("input",{id:"password",name:"password",type:"password",required:!0,className:"input w-full",placeholder:"Enter your password"})]}),C&&(0,a.jsx)("div",{className:"p-4 bg-red-50 border border-red-200 rounded-xl",children:(0,a.jsx)("p",{className:"text-sm text-red-600",children:C})}),(0,a.jsx)("button",{type:"submit",className:"btn w-full",children:"Sign In to Portal"})]})})]})});let B=(null==y?void 0:y.tasks)&&y.tasks.length>0?Math.round(y.tasks.filter(e=>e.completed).length/y.tasks.length*100):0,O=v.length>0?v.filter((e,s)=>{if(0===s)return!0;if(s-1>=0&&s-1<v.length){if(!e.check_in_date)return!1;let t=new Date(e.check_in_date),a=v[s-1];if(!(null==a?void 0:a.check_in_date))return!1;let l=new Date(a.check_in_date);return 1===Math.floor((t.getTime()-l.getTime())/864e5)}return!1}).length:0;return(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50",children:[(0,a.jsx)("nav",{className:"border-b border-gray-100 bg-white/80 backdrop-blur-md sticky top-0 z-50",children:(0,a.jsx)("div",{className:"container mx-auto px-4 sm:px-6 py-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 sm:space-x-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-blue-600 rounded-xl flex items-center justify-center",children:(0,a.jsx)("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),(0,a.jsx)("span",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:"Client Portal"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[(0,a.jsxs)("span",{className:"hidden sm:inline text-gray-600",children:["Welcome, ",null!=(u=null==N?void 0:N.first_name)?u:"Client","!"]}),(0,a.jsx)("button",{onClick:P,className:"btn-ghost px-3 sm:px-4 py-2 text-sm",children:"Sign Out"})]})]})})}),(0,a.jsxs)("main",{className:"container mx-auto px-4 sm:px-6 py-6 sm:py-8",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 sm:gap-6 mb-6 sm:mb-8",children:[(0,a.jsxs)("div",{className:"card p-4 sm:p-6",children:[(0,a.jsx)("h3",{className:"text-xs sm:text-sm font-medium text-gray-600 mb-2",children:"Compliance"}),(0,a.jsxs)("div",{className:"text-xl sm:text-2xl font-bold text-gray-900 mb-2",children:[B,"%"]}),(0,a.jsx)(i.k,{value:B,className:"h-2"})]}),(0,a.jsxs)("div",{className:"card p-4 sm:p-6",children:[(0,a.jsx)("h3",{className:"text-xs sm:text-sm font-medium text-gray-600 mb-2",children:"Sessions Done"}),(0,a.jsx)("div",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:v.length}),(0,a.jsx)("p",{className:"text-xs sm:text-sm text-gray-500",children:"Total check-ins"})]}),(0,a.jsxs)("div",{className:"card p-4 sm:p-6",children:[(0,a.jsx)("h3",{className:"text-xs sm:text-sm font-medium text-gray-600 mb-2",children:"Current Streak"}),(0,a.jsx)("div",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:O}),(0,a.jsx)("p",{className:"text-xs sm:text-sm text-gray-500",children:"Days in a row"})]}),(0,a.jsxs)("div",{className:"card p-4 sm:p-6",children:[(0,a.jsx)("h3",{className:"text-xs sm:text-sm font-medium text-gray-600 mb-2",children:"Current Weight"}),(0,a.jsx)("div",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:w.length>0?"".concat(null!=(g=null==(e=w[w.length-1])?void 0:e.weight_kg)?g:"N/A","kg"):"N/A"}),(0,a.jsx)("p",{className:"text-xs sm:text-sm text-gray-500",children:"Latest measurement"})]})]}),w.length>0&&(0,a.jsxs)("div",{className:"card p-6 mb-8",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Weight Progress"}),(0,a.jsx)("div",{className:"h-64",children:(0,a.jsx)(n.u,{width:"100%",height:"100%",children:(0,a.jsxs)(c.b,{data:w.filter(e=>e.weight_kg),children:[(0,a.jsx)(d.d,{strokeDasharray:"3 3"}),(0,a.jsx)(m.W,{dataKey:"metric_date",tickFormatter:e=>new Date(e).toLocaleDateString()}),(0,a.jsx)(o.h,{}),(0,a.jsx)(x.m,{labelFormatter:e=>new Date(e).toLocaleDateString(),formatter:e=>["".concat(e,"kg"),"Weight"]}),(0,a.jsx)(h.N,{type:"monotone",dataKey:"weight_kg",stroke:"#3b82f6",strokeWidth:2,dot:{fill:"#3b82f6",strokeWidth:2,r:4}})]})})})]}),y&&(0,a.jsxs)("div",{className:"card p-6 mb-8",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Current Weekly Plan"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Goals"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:null!=(p=null==(s=y.goals)?void 0:s.map((e,s)=>(0,a.jsx)("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm",children:e.title},s)))?p:(0,a.jsx)("span",{className:"text-gray-500 text-sm",children:"No goals set"})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900 mb-3",children:"Tasks"}),(0,a.jsx)("div",{className:"space-y-3",children:null!=(j=null==(t=y.tasks)?void 0:t.map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[(0,a.jsx)("div",{className:"w-5 h-5 rounded-lg flex items-center justify-center ".concat(e.completed?"bg-green-500 text-white":"bg-gray-200"),children:e.completed&&(0,a.jsx)("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("span",{className:"font-medium ".concat(e.completed?"line-through text-gray-500":"text-gray-900"),children:e.title}),e.description&&(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.description})]}),(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("workout"===e.category?"bg-red-100 text-red-800":"nutrition"===e.category?"bg-green-100 text-green-800":"mindfulness"===e.category?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"),children:e.category})]},e.id)))?j:(0,a.jsx)("span",{className:"text-gray-500 text-sm",children:"No tasks assigned"})})]})]})]}),v.length>0&&(0,a.jsxs)("div",{className:"card p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Check-ins"}),(0,a.jsx)("div",{className:"space-y-4",children:v.slice(0,5).map(e=>{var s,t;return(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsx)("span",{className:"text-sm text-gray-500",children:e.check_in_date?new Date(e.check_in_date).toLocaleDateString():"No date"}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-sm",children:[(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)("span",{className:"w-2 h-2 bg-yellow-400 rounded-full"}),"Mood: ",null!=(s=e.mood_rating)?s:"N/A","/5"]}),(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)("span",{className:"w-2 h-2 bg-blue-400 rounded-full"}),"Energy: ",null!=(t=e.energy_level)?t:"N/A","/5"]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.sleep_hours&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Sleep:"}),(0,a.jsxs)("span",{className:"ml-2 font-medium",children:[e.sleep_hours,"h"]})]}),e.water_intake_liters&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Water:"}),(0,a.jsxs)("span",{className:"ml-2 font-medium",children:[e.water_intake_liters,"L"]})]}),e.weight_kg&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Weight:"}),(0,a.jsxs)("span",{className:"ml-2 font-medium",children:[e.weight_kg,"kg"]})]}),e.body_fat_percentage&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Body Fat:"}),(0,a.jsxs)("span",{className:"ml-2 font-medium",children:[e.body_fat_percentage,"%"]})]})]}),e.notes&&(0,a.jsx)("p",{className:"text-gray-700 mt-3 pt-3 border-t border-gray-200",children:e.notes})]},e.id)})})]})]})]})}},9671:(e,s,t)=>{"use strict";t.d(s,{UU:()=>m});var a=t(2880),l=t(927);t(9509),l.Ik({NEXT_PUBLIC_SUPABASE_URL:l.Yj().url(),NEXT_PUBLIC_SUPABASE_ANON_KEY:l.Yj().min(1),SUPABASE_SERVICE_ROLE_KEY:l.Yj().optional(),DEFAULT_COACH_ID:l.Yj().uuid().optional(),NODE_ENV:l.k5(["development","test","production"]).default("development")});let r=l.Ik({NEXT_PUBLIC_SUPABASE_URL:l.Yj().url(),NEXT_PUBLIC_SUPABASE_ANON_KEY:l.Yj().min(1)}),i=null,{NEXT_PUBLIC_SUPABASE_URL:n,NEXT_PUBLIC_SUPABASE_ANON_KEY:c}=i=r.parse({NEXT_PUBLIC_SUPABASE_URL:"https://nsywiycphpinmipdufrd.supabase.co",NEXT_PUBLIC_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5zeXdpeWNwaHBpbm1pcGR1ZnJkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ3OTY4NTQsImV4cCI6MjA3MDM3Mjg1NH0.1NW5kVn2ndoR_QqY7fEn7LUsBwNNKsg-MnnQJXely14"}),d=(0,a.kT)(n,c,{cookies:{get:()=>void 0,set:()=>{},remove:()=>{}},auth:{persistSession:!0,autoRefreshToken:!0}}),m=()=>d},9728:(e,s,t)=>{Promise.resolve().then(t.bind(t,5086))}},e=>{e.O(0,[782,4277,448,8441,5964,7358],()=>e(e.s=9728)),_N_E=e.O()}]);