# HT-023.1.3 Custom Micro-App Template Structure

## Overview

Comprehensive custom micro-app template structure designed for rapid deployment and client customization. Built on the Template Engine Architecture (HT-023.1.1) and Responsive Design System (HT-023.1.2) to enable â‰¤7 day delivery cycles with AI assistance.

## Core Template Architecture

### 1. Micro-App Template Patterns

**Base Template Structure:**
```typescript
// lib/template-engine/templates/micro-app.ts
interface MicroAppTemplate {
  id: string;
  name: string;
  version: string;
  category: MicroAppCategory;
  structure: TemplateStructure;
  configuration: MicroAppConfig;
  components: ComponentRegistry;
  layouts: LayoutRegistry;
  themes: ThemeRegistry;
  presets: PresetRegistry;
}

interface MicroAppCategory {
  type: 'lead-generation' | 'e-commerce' | 'booking' | 'content' | 'dashboard' | 'portal';
  industry: 'healthcare' | 'beauty' | 'real-estate' | 'consulting' | 'saas' | 'general';
  complexity: 'simple' | 'standard' | 'advanced';
  features: FeatureSet[];
}
```

**Template Structure Definition:**
```typescript
// lib/template-engine/templates/structure.ts
interface TemplateStructure {
  pages: PageDefinition[];
  navigation: NavigationStructure;
  layouts: LayoutHierarchy;
  data: DataStructure;
  integrations: IntegrationPoints;
  customization: CustomizationMap;
}

interface PageDefinition {
  id: string;
  path: string;
  layout: string;
  components: ComponentPlacement[];
  data: DataBinding[];
  seo: SEOConfiguration;
  responsive: ResponsiveOverrides;
}
```

### 2. Common Layout Templates

**Layout Template Library:**
```typescript
// lib/template-engine/layouts/common.ts
interface LayoutTemplate {
  id: string;
  name: string;
  category: LayoutCategory;
  structure: LayoutStructure;
  responsive: ResponsiveBreakpoints;
  customization: CustomizationPoints;
}

// Core Layout Categories
enum LayoutCategory {
  LANDING = 'landing',           // Single-page lead capture
  MULTI_STEP = 'multi-step',     // Multi-step forms/wizards
  DASHBOARD = 'dashboard',       // Data visualization/management
  PORTAL = 'portal',             // User/client portals
  CONTENT = 'content',           // Content-heavy pages
  E_COMMERCE = 'e-commerce',     // Product/service catalogs
  BOOKING = 'booking'            // Appointment/reservation systems
}
```

**Layout Pattern Definitions:**

1. **Landing Page Layout**
```typescript
const LandingPageLayout: LayoutTemplate = {
  id: 'landing-hero-form',
  name: 'Hero with Lead Capture Form',
  category: LayoutCategory.LANDING,
  structure: {
    header: { type: 'minimal', sticky: true },
    hero: {
      type: 'split',
      content: 'left',
      media: 'right',
      cta: 'primary'
    },
    features: { type: 'grid', columns: 3 },
    testimonials: { type: 'carousel', autoplay: true },
    form: { type: 'inline', position: 'hero' },
    footer: { type: 'minimal' }
  },
  responsive: {
    mobile: { hero: 'stacked', features: 'stacked' },
    tablet: { hero: 'split', features: 'grid-2' },
    desktop: { hero: 'split', features: 'grid-3' }
  }
};
```

2. **Multi-Step Form Layout**
```typescript
const MultiStepFormLayout: LayoutTemplate = {
  id: 'multi-step-questionnaire',
  name: 'Progressive Questionnaire',
  category: LayoutCategory.MULTI_STEP,
  structure: {
    header: { type: 'progress', showSteps: true },
    content: {
      type: 'centered',
      maxWidth: '600px',
      padding: 'comfortable'
    },
    navigation: {
      type: 'step-controls',
      position: 'bottom',
      style: 'prominent'
    },
    sidebar: {
      type: 'progress-indicator',
      position: 'left',
      hideOnMobile: true
    }
  },
  responsive: {
    mobile: { sidebar: 'hidden', content: 'full-width' },
    tablet: { sidebar: 'collapsed', content: '80%' },
    desktop: { sidebar: 'expanded', content: '60%' }
  }
};
```

3. **Dashboard Layout**
```typescript
const DashboardLayout: LayoutTemplate = {
  id: 'admin-dashboard',
  name: 'Administrative Dashboard',
  category: LayoutCategory.DASHBOARD,
  structure: {
    header: { type: 'full', navigation: true, user: true },
    sidebar: {
      type: 'navigation',
      collapsible: true,
      width: '280px'
    },
    main: {
      type: 'grid',
      areas: ['stats', 'charts', 'tables'],
      gaps: 'comfortable'
    },
    footer: { type: 'minimal' }
  },
  responsive: {
    mobile: { sidebar: 'overlay', main: 'stacked' },
    tablet: { sidebar: 'collapsed', main: 'grid-2' },
    desktop: { sidebar: 'expanded', main: 'grid-3' }
  }
};
```

### 3. Customization Points System

**Comprehensive Customization Framework:**
```typescript
// lib/template-engine/customization/points.ts
interface CustomizationPoint {
  id: string;
  type: CustomizationType;
  scope: CustomizationScope;
  options: CustomizationOptions;
  validation: ValidationRules;
  dependencies: CustomizationDependency[];
}

enum CustomizationType {
  BRANDING = 'branding',           // Colors, fonts, logos
  CONTENT = 'content',             // Text, images, copy
  LAYOUT = 'layout',               // Structure, spacing, arrangement
  BEHAVIOR = 'behavior',           // Interactions, animations
  INTEGRATION = 'integration',     // APIs, webhooks, third-party
  FUNCTIONALITY = 'functionality'  // Features, modules, capabilities
}

enum CustomizationScope {
  GLOBAL = 'global',               // Affects entire app
  PAGE = 'page',                   // Page-specific
  COMPONENT = 'component',         // Component-level
  ELEMENT = 'element'              // Individual elements
}
```

**Branding Customization Points:**
```typescript
const BrandingCustomization: CustomizationPoint[] = [
  {
    id: 'primary-color',
    type: CustomizationType.BRANDING,
    scope: CustomizationScope.GLOBAL,
    options: {
      type: 'color-picker',
      defaultValue: '#3B82F6',
      presets: ['#E91E63', '#9C27B0', '#3F51B5', '#2196F3', '#009688'],
      validation: { format: 'hex', contrast: 'AA' }
    }
  },
  {
    id: 'logo-upload',
    type: CustomizationType.BRANDING,
    scope: CustomizationScope.GLOBAL,
    options: {
      type: 'file-upload',
      formats: ['svg', 'png', 'jpg'],
      maxSize: '2MB',
      dimensions: { min: '200x200', max: '800x800' }
    }
  },
  {
    id: 'font-family',
    type: CustomizationType.BRANDING,
    scope: CustomizationScope.GLOBAL,
    options: {
      type: 'select',
      choices: [
        { value: 'inter', label: 'Inter (Modern)', preview: 'font-inter' },
        { value: 'poppins', label: 'Poppins (Friendly)', preview: 'font-poppins' },
        { value: 'playfair', label: 'Playfair (Elegant)', preview: 'font-playfair' }
      ]
    }
  }
];
```

**Content Customization Points:**
```typescript
const ContentCustomization: CustomizationPoint[] = [
  {
    id: 'hero-headline',
    type: CustomizationType.CONTENT,
    scope: CustomizationScope.PAGE,
    options: {
      type: 'rich-text',
      maxLength: 120,
      placeholder: 'Your compelling headline...',
      formatting: ['bold', 'italic', 'link']
    }
  },
  {
    id: 'hero-image',
    type: CustomizationType.CONTENT,
    scope: CustomizationScope.COMPONENT,
    options: {
      type: 'media-library',
      formats: ['jpg', 'png', 'webp'],
      aspectRatio: '16:9',
      responsive: true
    }
  },
  {
    id: 'contact-form-fields',
    type: CustomizationType.FUNCTIONALITY,
    scope: CustomizationScope.COMPONENT,
    options: {
      type: 'field-builder',
      available: ['text', 'email', 'phone', 'select', 'textarea', 'checkbox'],
      required: ['name', 'email'],
      validation: true
    }
  }
];
```

### 4. Template Composition Rules

**Composition Engine:**
```typescript
// lib/template-engine/composition/rules.ts
interface CompositionRule {
  id: string;
  condition: RuleCondition;
  action: RuleAction;
  priority: number;
  dependencies: string[];
}

interface RuleCondition {
  type: 'device' | 'content' | 'user' | 'feature';
  operator: 'equals' | 'contains' | 'greaterThan' | 'exists';
  value: any;
}

interface RuleAction {
  type: 'include' | 'exclude' | 'replace' | 'modify';
  target: string;
  params: Record<string, any>;
}
```

**Example Composition Rules:**
```typescript
const CompositionRules: CompositionRule[] = [
  {
    id: 'mobile-navigation-collapse',
    condition: { type: 'device', operator: 'equals', value: 'mobile' },
    action: {
      type: 'replace',
      target: 'navigation',
      params: { variant: 'hamburger', overlay: true }
    },
    priority: 100,
    dependencies: []
  },
  {
    id: 'payment-module-conditional',
    condition: { type: 'feature', operator: 'equals', value: 'payments' },
    action: {
      type: 'include',
      target: 'payment-form',
      params: { position: 'after-contact-form' }
    },
    priority: 80,
    dependencies: ['contact-form']
  },
  {
    id: 'testimonials-min-content',
    condition: { type: 'content', operator: 'greaterThan', value: 2 },
    action: {
      type: 'include',
      target: 'testimonials-section',
      params: { layout: 'carousel' }
    },
    priority: 60,
    dependencies: ['hero-section']
  }
];
```

### 5. Template Validation System

**Multi-Layer Validation:**
```typescript
// lib/template-engine/validation/system.ts
interface ValidationSystem {
  structural: StructuralValidator;
  content: ContentValidator;
  accessibility: AccessibilityValidator;
  performance: PerformanceValidator;
  branding: BrandingValidator;
}

interface ValidationResult {
  valid: boolean;
  errors: ValidationError[];
  warnings: ValidationWarning[];
  suggestions: ValidationSuggestion[];
  score: ValidationScore;
}

interface ValidationError {
  id: string;
  type: ValidationErrorType;
  severity: 'critical' | 'high' | 'medium' | 'low';
  message: string;
  location: ValidationLocation;
  fixes: AutoFix[];
}
```

**Validation Rule Examples:**
```typescript
const ValidationRules = {
  structural: [
    {
      id: 'required-pages',
      rule: 'Templates must include at least one page',
      check: (template) => template.pages.length > 0,
      autoFix: 'Add default landing page'
    },
    {
      id: 'navigation-consistency',
      rule: 'All navigation links must have corresponding pages',
      check: (template) => validateNavigationLinks(template),
      autoFix: 'Remove broken links or add missing pages'
    }
  ],
  content: [
    {
      id: 'hero-content-present',
      rule: 'Hero sections must have headline and description',
      check: (template) => validateHeroContent(template),
      autoFix: 'Add placeholder content'
    },
    {
      id: 'image-alt-text',
      rule: 'All images must have alt text',
      check: (template) => validateImageAltText(template),
      autoFix: 'Generate descriptive alt text'
    }
  ],
  accessibility: [
    {
      id: 'color-contrast',
      rule: 'Text must meet WCAG AA contrast requirements',
      check: (template) => validateColorContrast(template),
      autoFix: 'Adjust colors for better contrast'
    },
    {
      id: 'focus-indicators',
      rule: 'Interactive elements must have focus indicators',
      check: (template) => validateFocusIndicators(template),
      autoFix: 'Add focus styles'
    }
  ]
};
```

## Micro-App Template Categories

### 1. Lead Generation Templates

**Questionnaire/Survey Apps:**
```typescript
const QuestionnaireTemplate: MicroAppTemplate = {
  id: 'questionnaire-lead-gen',
  name: 'Lead Generation Questionnaire',
  category: {
    type: 'lead-generation',
    industry: 'general',
    complexity: 'standard',
    features: ['multi-step-form', 'analytics', 'email-integration']
  },
  structure: {
    pages: [
      { id: 'landing', path: '/', layout: 'hero-form' },
      { id: 'questionnaire', path: '/questionnaire', layout: 'multi-step' },
      { id: 'results', path: '/results', layout: 'consultation' }
    ],
    navigation: { type: 'progress', showSteps: true },
    data: { questions: 'dynamic', answers: 'session-storage' }
  }
};
```

**Consultation Booking:**
```typescript
const ConsultationTemplate: MicroAppTemplate = {
  id: 'consultation-booking',
  name: 'Professional Consultation Booking',
  category: {
    type: 'booking',
    industry: 'consulting',
    complexity: 'standard',
    features: ['calendar-integration', 'payment', 'automation']
  },
  structure: {
    pages: [
      { id: 'services', path: '/', layout: 'service-grid' },
      { id: 'booking', path: '/book', layout: 'calendar-form' },
      { id: 'confirmation', path: '/confirmed', layout: 'success' }
    ]
  }
};
```

### 2. Industry-Specific Templates

**Healthcare/Beauty:**
```typescript
const HealthcareTemplate: MicroAppTemplate = {
  id: 'healthcare-intake',
  name: 'Patient Intake System',
  category: {
    type: 'lead-generation',
    industry: 'healthcare',
    complexity: 'advanced',
    features: ['hipaa-compliance', 'secure-forms', 'integration']
  },
  customization: {
    required: ['clinic-name', 'logo', 'contact-info'],
    optional: ['color-scheme', 'additional-fields', 'intake-flow'],
    restricted: ['compliance-settings', 'security-config']
  }
};
```

**Real Estate:**
```typescript
const RealEstateTemplate: MicroAppTemplate = {
  id: 'property-inquiry',
  name: 'Property Inquiry System',
  category: {
    type: 'lead-generation',
    industry: 'real-estate',
    complexity: 'standard',
    features: ['property-search', 'contact-forms', 'mls-integration']
  },
  presets: {
    residential: { focus: 'home-buyers', forms: 'buyer-qualification' },
    commercial: { focus: 'investors', forms: 'investment-criteria' },
    rental: { focus: 'tenants', forms: 'rental-application' }
  }
};
```

### 3. E-commerce Templates

**Product Catalog:**
```typescript
const ProductCatalogTemplate: MicroAppTemplate = {
  id: 'product-showcase',
  name: 'Product Showcase & Inquiry',
  category: {
    type: 'e-commerce',
    industry: 'general',
    complexity: 'standard',
    features: ['product-grid', 'inquiry-forms', 'gallery']
  },
  structure: {
    pages: [
      { id: 'catalog', path: '/', layout: 'product-grid' },
      { id: 'product', path: '/product/[id]', layout: 'product-detail' },
      { id: 'inquiry', path: '/inquire', layout: 'contact-form' }
    ]
  }
};
```

## Implementation Architecture

### Directory Structure
```
lib/template-engine/templates/
â”œâ”€â”€ micro-apps/
â”‚   â”œâ”€â”€ categories/
â”‚   â”‚   â”œâ”€â”€ lead-generation.ts     # Lead gen template definitions
â”‚   â”‚   â”œâ”€â”€ e-commerce.ts          # E-commerce templates
â”‚   â”‚   â”œâ”€â”€ booking.ts             # Booking/appointment templates
â”‚   â”‚   â””â”€â”€ content.ts             # Content-focused templates
â”‚   â”œâ”€â”€ layouts/
â”‚   â”‚   â”œâ”€â”€ landing.ts             # Landing page layouts
â”‚   â”‚   â”œâ”€â”€ multi-step.ts          # Multi-step form layouts
â”‚   â”‚   â”œâ”€â”€ dashboard.ts           # Dashboard layouts
â”‚   â”‚   â””â”€â”€ portal.ts              # Portal layouts
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ forms.ts               # Form component templates
â”‚   â”‚   â”œâ”€â”€ navigation.ts          # Navigation templates
â”‚   â”‚   â”œâ”€â”€ content.ts             # Content block templates
â”‚   â”‚   â””â”€â”€ media.ts               # Media component templates
â”‚   â””â”€â”€ presets/
â”‚       â”œâ”€â”€ healthcare.ts          # Healthcare industry presets
â”‚       â”œâ”€â”€ beauty.ts              # Beauty/salon presets
â”‚       â”œâ”€â”€ real-estate.ts         # Real estate presets
â”‚       â””â”€â”€ consulting.ts          # Consulting presets
â”œâ”€â”€ customization/
â”‚   â”œâ”€â”€ points.ts                  # Customization point definitions
â”‚   â”œâ”€â”€ rules.ts                   # Customization rules engine
â”‚   â”œâ”€â”€ validation.ts              # Customization validation
â”‚   â””â”€â”€ presets.ts                 # Customization preset library
â”œâ”€â”€ composition/
â”‚   â”œâ”€â”€ engine.ts                  # Template composition engine
â”‚   â”œâ”€â”€ rules.ts                   # Composition rules
â”‚   â”œâ”€â”€ resolver.ts                # Dependency resolution
â”‚   â””â”€â”€ optimizer.ts               # Composition optimization
â””â”€â”€ validation/
    â”œâ”€â”€ system.ts                  # Validation system core
    â”œâ”€â”€ structural.ts              # Structural validation
    â”œâ”€â”€ content.ts                 # Content validation
    â”œâ”€â”€ accessibility.ts           # A11y validation
    â””â”€â”€ performance.ts             # Performance validation
```

### Template Registry System
```typescript
// lib/template-engine/registry/templates.ts
export class MicroAppTemplateRegistry {
  private templates: Map<string, MicroAppTemplate> = new Map();
  private categories: Map<string, MicroAppTemplate[]> = new Map();
  private presets: Map<string, TemplatePreset> = new Map();

  registerTemplate(template: MicroAppTemplate): void {
    this.templates.set(template.id, template);
    this.indexByCategory(template);
  }

  getTemplatesByCategory(category: MicroAppCategory): MicroAppTemplate[] {
    return this.categories.get(this.getCategoryKey(category)) || [];
  }

  getTemplatesByIndustry(industry: string): MicroAppTemplate[] {
    return Array.from(this.templates.values())
      .filter(template => template.category.industry === industry);
  }

  composeTemplate(
    templateId: string,
    customizations: CustomizationSet
  ): ComposedTemplate {
    const template = this.templates.get(templateId);
    if (!template) throw new Error(`Template ${templateId} not found`);

    return this.composer.compose(template, customizations);
  }
}
```

## Verification Checkpoints Status

âœ… **Custom micro-app template patterns defined**
- Comprehensive MicroAppTemplate interface with category system
- Industry-specific templates (healthcare, beauty, real estate, consulting)
- Template complexity levels (simple, standard, advanced)
- Feature-based template classification system

âœ… **Common layout templates designed**
- Landing page layouts (hero-form, split-content, feature-focused)
- Multi-step form layouts (questionnaire, wizard, progressive)
- Dashboard layouts (admin, analytics, management)
- Portal layouts (client portals, user dashboards)
- E-commerce layouts (product grids, detail pages, checkout)

âœ… **Customization points identified**
- Branding customization (colors, fonts, logos, imagery)
- Content customization (text, media, copy, messaging)
- Layout customization (structure, spacing, arrangement)
- Functionality customization (features, integrations, modules)
- Behavioral customization (interactions, animations, UX)

âœ… **Template composition rules established**
- Device-responsive composition rules
- Feature-conditional inclusion/exclusion
- Content-based layout decisions
- User preference adaptations
- Performance-optimized rendering

âœ… **Template validation system planned**
- Multi-layer validation (structural, content, accessibility, performance)
- Automated error detection and fixing
- WCAG compliance validation
- Performance impact assessment
- Brand consistency verification

## Integration Points

### Template Engine Integration
- **Seamless composition**: Templates integrate with HT-023.1.1 Template Engine
- **Responsive adaptation**: Full integration with HT-023.1.2 Responsive Design System
- **Branding application**: Automatic brand application across all templates
- **Version management**: Template versioning and rollback capabilities

### Development Workflow
- **Template preview**: Live preview with customizations
- **Validation feedback**: Real-time validation and suggestions
- **Export capability**: Generate production-ready code
- **Testing integration**: Automated template testing workflows

### Client Delivery
- **Rapid deployment**: â‰¤7 day client delivery cycles
- **Self-service customization**: Client-accessible customization interface
- **Brand compliance**: Automatic brand guideline enforcement
- **Performance optimization**: Built-in performance best practices

This custom micro-app template structure provides a comprehensive foundation for rapid client delivery and customization, enabling agencies to create professional, branded micro-applications with minimal development time while maintaining high quality and consistency.